# 일일 개발 보고서 (Daily Development Report)

## 1. 요약 (Summary)
* **핵심 키워드**: ROS2 Service Client, Jupyter Notebook Debugging, Process Management, RViz2 Visualization, Xorg Configuration

## 2. 일일 목표 및 계획 (Daily Goals & Plan)
* **주요 목표**: ROS2 Service 통신 구조 이해 및 Jupyter 환경에서의 노드 프로토타이핑, RViz2를 활용한 센서 데이터 시각화 실습
* **소요 시간**: 약 7시간

## 3. 수행 작업 내용 (Work Performed)
### 코드 개발/구현
- **구현 1: Service Client 노드 개발 및 디버깅**
  - `client_test` 서비스 클라이언트 노드 작성 및 Request/Response 동작 테스트.
  - 비동기 통신 구조에서의 노드 중복 실행 문제 확인 및 프로세스 관리 기법 적용.
- **구현 2: Jupyter Notebook 기반 Temperature Publisher/Subscriber 프로토타이핑**
  - `temperature_example(추가기능).ipynb`를 활용한 단일 스크립트 내 Pub/Sub 로직 구현.
  - 인터랙티브 환경에서의 루프(Spin) 제어 및 출력 버퍼링 처리.
- **구현 3: RViz2 활용 센서 데이터 시각화**
  - `ros2 bag play`를 통한 기록된 센서 데이터(Luminar LiDAR, Camera 등) 재생.
  - `ros2 topic echo` 옵션을 활용한 헤더 정보(Frame ID) 추출 및 시각화 파라미터 매핑.

### 디버깅 및 테스트
- **테스트 환경**: Ubuntu 22.04.5 (Native Dual-boot), ROS2 Humble, i7 CPU, GTX 1060, 8GB RAM (Xorg Session)
- **주요 이슈 해결**:
  - **프로세스 잔존**: VS Code 내 터미널 종료 후에도 백그라운드 프로세스가 남아 노드 통신이 꼬이는 현상 확인.
  - **그래픽스 호환성**: Wayland 세션에서의 RViz2 렌더링 호환성 문제 확인 및 조치.

### 학습 및 연구
- **ROS2 Node Lifecycle**: 노드 종료 시(`destroy_node`) 명시적 자원 해제의 중요성 및 좀비 프로세스 처리 방법 학습.
- **Visualization Frame**: RViz2의 `Fixed Frame`과 실제 데이터(`header.frame_id`) 간의 일치 필요성 이해.

## 4. 문제점 및 해결 과정 (Issues & Solutions)
- **문제점 1: Service Client 무응답 및 무한 대기**
  - **현상**: `client_test` 노드 실행 시 응답 없이 프로세스가 계속 대기 상태 유지.
  - **원인**: 이전 실행 시 정상 종료되지 않은 노드가 백그라운드에 남아 있어, `ros2 node list` 확인 결과 동일 명칭의 노드 4개가 중복 실행 중이었음.
  - **해결**: `killall -9 python3` 명령어로 모든 파이썬 프로세스 강제 종료 후 재실행하여 정상 동작 확인.

- **문제점 2: Jupyter Notebook 내 출력 지연 및 셀 잠김**
  - **현상**: `temperature_example` 실행 시 에러 메시지 없이 결과가 출력되지 않고 셀이 실행 중(In-progress) 상태로 멈춤.
  - **원인**: 단일 스레드/프로세스 환경인 Jupyter 셀 내에서 Blocking 호출이나 Pub/Sub 순서 로직이 꼬여 이벤트 루프가 막힘.
  - **해결**: `spin_once`의 타임아웃 설정 및 `print` 문에 `flush=True` 옵션을 추가하여 출력 버퍼 강제 비움 처리.

- **문제점 3: RViz2 실행 불가 및 경고 발생**
  - **현상**: `rviz2` 실행 시 Wayland 관련 경고(`Ignoring XDG_SESSION_TYPE=wayland`) 발생 및 화면 렌더링 불가.
  - **원인**: Ubuntu 22.04 기본값인 Wayland 디스플레이 서버와 ROS2/Qt GUI 간의 호환성 부족.
  - **해결**: Ubuntu 로그인 세션을 'Ubuntu on Xorg'로 변경하여 Native X11 환경으로 전환 후 해결.

- **문제점 4: RViz2 Fixed Frame 설정 불일치**
  - **현상**: Bag 파일 재생 후 센서 데이터가 화면에 표시되지 않음.
  - **원인**: Bag 파일 내부의 토픽 이름과 실제 데이터의 `frame_id`가 다름을 인지하지 못함.
  - **해결**: `ros2 topic echo /vehicle_8/luminar_front_points --no-arr --once` 명령어를 통해 실제 Header의 `frame_id`를 확인하고 RViz Global Options에 적용.

## 5. 배운점 및 다음 단계 (Learned & Next Steps)
- **배운점**:
  - **프로세스 관리**: IDE(VS Code)에서 실행 중지 버튼을 눌러도 실제 프로세스가 살아있을 수 있음을 인지, CLI를 통한 확실한 프로세스 킬(`kill`, `killall`) 습관화 필요.
  - **데이터 검증**: 시각화 도구 사용 전 `ros2 topic echo` 등을 통해 Raw Data의 Header 정보를 먼저 검증하는 절차의 중요성 체득.
- **다음 단계**:
  - TF(Transform) 트리의 개념 학습 및 `tf2_tools`를 활용한 프레임 간 관계 시각화.
  - Custom Interface(msg, srv)를 활용한 독자적인 데이터 구조 설계.

## 6. 레퍼런스 (References)
**commit** : rviz2 실습, jupyter를 활용한 topic, subscriber, action 실습
**src**
- [Jupyter Pub/Sub Order Issue](../../src/2025_12_29_1_Jupyter_PubSub_Order_Issue.webm)
- [Killall Node Process](../../src/2025_12_29_2_Killall_Node_Process.png)
- [Killall Kernel Error Log](../../src/2025_12_29_3_Killall_Kernel_Error_Log.png)
- [GPU Driver Error](../../src/2025_12_29_4_GPU_Driver_Error.png)
- [Rviz2 Realsense Launch](../../src/2025_12_29_5_Rviz2_Realsense_Launch.png)
- [Rviz2 Practice Screen](../../src/2025_12_29_6_Rviz2_Practice_Screen.png)
