## 일일 개발 보고서 (Daily Development Report)

**작성자:** MARKCH
**날짜:** 2025년 12월 25일
**주제:** ROS2 인터페이스 프로그래밍 응용 및 노드 간 통신 분석

---

## 1. 요약 (Summary)
ROS2 Interface Programming, Node Communication Analysis, Action Feedback Synchronization, Debugging

## 2. 일일 목표 및 계획 (Daily Goals & Plan)
* **목표**: `ex_calculator` 패키지 구현을 통한 ROS2 인터페이스(Topic, Service, Action) 복합 활용 능력 습득
* **세부 계획**:
    * 계산기 시스템(`ex_calculator`) 패키지 설계 및 구현
    * Node, Topic, Service, Action 간의 데이터 흐름 분석
    * Multi-node 실행 환경에서의 비동기 통신 문제 해결

## 3. 수행 작업 내용 (Work Performed)

### 코드 개발/구현
* **구현 1: Topic 통신 (`argument` Node)**
    * 랜덤한 `float32` 타입의 연산 인자(a, b)를 생성하여 `arithmetic_argument` 토픽으로 발행
    * Publisher 노드 분석: 별도의 Return 값 없이 데이터 송신 함수 실행 자체에 집중하는 단방향 통신 구조 확인
* **구현 2: Service 통신 (`operator` <-> `calculator`)**
    * `operator` 노드에서 연산자(+, -, *, /)를 요청(Request)하고 `calculator` 노드에서 연산 결과를 응답(Response)
    * Service Server 분석: DDSI-RTPS 알고리즘 기반으로 수신된 msg 파일을 파이썬 객체로 할당하여 연산 처리 수행
* **구현 3: Action 통신 (`checker` <-> `calculator`)**
    * `checker` 노드에서 목표 합계 값(`goal_sum`)을 설정하여 Action Goal 전송
    * `send_goal_total_sum` 함수 기능 분석: `send_goal` 역할을 수행하며, 설정된 총 횟수(또는 목표값) 만족 시 추가 작동을 중단시키는 트리거 역할 수행

### 디버깅 및 테스트
* **테스트 환경**: Ubuntu 22.04.5, ROS2 Humble, CPU i7, GPU 1060, RAM 8GB
* **시스템 구성 분석**:
    * 총 4개의 노드 구동: `argument`, `operator`, `calculator`, `checker`
    * 서버 구성: `calculator` 노드 내 Service Server, Action Server 등 총 3개의 서버 인스턴스 존재 확인

### 학습 및 연구
* **복합 노드 구조**: `calculator` 노드는 Topic Subscriber, Service Server, Action Server 역할을 동시에 수행하는 복합 노드임을 확인
* **데이터 흐름**: `argument`(Topic) -> `calculator` <- `operator`(Service) 구조에서 연산된 결과가 `checker`(Action)로 피드백되는 전체 파이프라인 분석

## 4. 문제점 및 해결 과정 (Issues & Solutions)
* **문제점 1**: Action Feedback 값 불일치 현상 발생
    * **현상**: `checker` 노드 터미널에 출력된 Feedback 누적 합계(약 131.25)와 실제 로직상 계산되어야 할 정확한 값(95.26) 사이에 약 -36.00의 오차 발생
    * **원인**:
        * `calculator` 노드(Action Server)의 연산 루프 속도(1초)가 `operator` 노드를 통한 사용자 수동 입력 속도보다 빠름
        * 사용자 입력 대기 시간 동안 `calculator`가 이전 연산 결과(예: -3.0)를 중복하여 누적 합산함 (약 12회 중복 발생)
        * 화면 출력 버퍼 이슈로 중복된 로그 일부가 누락되어 육안상 확인된 값과 내부 실제 값의 괴리 발생
    * **해결**: `calculator.py` 내의 `execute_checker` 함수에서 `time.sleep` 값을 기존 1초에서 **5초**로 연장 수정. 사용자 입력 속도와의 동기화를 맞춰 안정적인 값 변화 확인

## 5. 배운점 및 다음 단계 (Learned & Next Steps)
* **배운점**:
    * ROS2 통신에서 노드 간 타이밍 비동기화가 데이터 무결성에 미치는 영향 이해
    * Topic(단방향/지속성), Service(양방향/일회성), Action(양방향/장기작업)의 명확한 역할 구분 및 코드 레벨 구현 원리 습득
    * Publisher/Subscriber와 Server/Client 객체 간의 데이터 매핑 과정 이해
* **다음 단계**:
    * Launch 파일을 활용한 다중 노드 동시 실행 및 파라미터 관리 학습
    * ROS2 파라미터(Parameter) 기능을 활용한 동적 설정 변경 실습

## 6. 레퍼런스 (References)
